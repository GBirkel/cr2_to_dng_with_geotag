<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="stylesheet" href="https://mile42.net/wp-content/plugins/ptws/css/leaflet.css">
  <script src="https://mile42.net/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
  <script src="https://mile42.net/wp-content/plugins/ptws/js/leaflet.js"></script>
  <script src="https://mile42.net/wp-content/plugins/ptws/js/Chart.bundle.min.js" type="text/javascript"></script>

  <title>PTWS Chart Template</title>
<style>

.ptws-ride-log {
    border: #ccc 1px solid;
    border-radius: 10px;
    padding: 4px;
    margin: 1.5em auto;
    width: 640px;
    background-color: #F8F8F8;
}

.ptws-ride-log > div.data {
  display:none;
}

.ptws-ride-log .ptws-routemap {
    padding: 0;
    margin: 0;
    width: 640px;
    background-color: #F8F8F8;
}

.ptws-ride-log .ptws-routemap > div {
    height: 400px;
}

.ptws-ride-log .ptws-elevation-chart {
    border-radius: 0 0 10px 10px;
    padding: 7px 0 0 0;
    margin: 0;
    width: 640px;
    background-color: #F8F8F8;
}

.ptws-ride-log .ptws-elevation-chart > canvas {
    height: 140px;
}

</style>
  <script type="text/javascript"> 

function doUpload() {
    var jqRideLogDiv = jQuery('div.ptws-ride-log').first();
    var rideLogId = jqRideLogDiv.attr('rideid');
    var rawDataStr = jQuery(jqRideLogDiv).children().first().text()
    rawDataStr = rawDataStr.replace(/\r?\n|\r/g, " ");

    var data = {
        'route': rawDataStr,
        'id': rideLogId
    };
    console.log(data);
    // We can also pass the url value separately from ajaxurl for front end AJAX implementations
    jQuery.post('http://localhost/wp-json/ptws/v1/route', data, function (response) {
        jQuery('div.responsebox').text(response);
    });
}


function initialize() {
    jQuery('#uploadButton').click(function () { doUpload(); });

    // Call the route parsing/display code in ptws.js
    ptws.findAndInitGPSLogDisplays();
}

  </script> 
</head>
<body onload="initialize();">

<h1>Ride Log Template</h1>

<input type=button value="Upload" name="uploadButton" id="uploadButton" />

<div class="responsebox"></div>

<!-- note: body and html tags are intentionally left off this template file -->
